----Set SalesPart Obsolete

DROP TABLE MTK_INVENTORY_PART_CF_TAB;

CREATE TABLE MTK_INVENTORY_PART_CF_TAB
(
   PART_NO                            VARCHAR2(25)        NOT NULL,
   CONTRACT                           VARCHAR2(5)         NOT NULL
);

SELECT 'INSERT INTO MTK_INVENTORY_PART_CF_TAB (PART_NO,CONTRACT) VALUES (''' 
+ LTRIM(RTRIM(PART_NO)) 
+ ''',''' + CONTRACT 
+  ''');'   aa
FROM ( SELECT  [Part No]	PART_NO  
	  ,'1'				CONTRACT
  FROM [dbo].[deactivate_sales_parts$]
  GROUP BY [Part No]) aaa


DECLARE   
   CURSOR get_qaman IS
      SELECT a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion
		FROM  INVENTORY_PART a
      INNER JOIN MTK_INVENTORY_PART_CF_TAB b ON b.PART_NO = a.PART_NO
      WHERE a.part_status = 'O'
      GROUP BY a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion;      

   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000);   
   
BEGIN
   
   FOR row_ IN get_qaman LOOP
      IF Inventory_Part_In_Stock_API.Check_Part_Exist(row_.contract, row_.part_no) THEN
         CONTINUE;
      END IF;
      
      objid_ := row_.objid;
      objversion_ := row_.objversion;
      
      Client_SYS.Clear_Attr(attr_);
      Client_SYS.Add_To_Attr('PART_STATUS', 'A', attr_);      
      
      INVENTORY_PART_API.MODIFY__(info_, objid_, objversion_, attr_, 'DO');
      --COMMIT;
   END LOOP;   
END;

---Deactivate SaleParts
DECLARE   
   CURSOR get_qaman IS
      SELECT a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion
		FROM  SALES_PART a
      INNER JOIN MTK_INVENTORY_PART_CF_TAB b ON b.PART_NO = a.PART_NO
      WHERE a.ACTIVEIND_DB <> 'N'
      GROUP BY a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion;      

   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000);   
   
BEGIN
   
   FOR row_ IN get_qaman LOOP
      
      objid_ := row_.objid;
      objversion_ := row_.objversion;
      
      Client_SYS.Clear_Attr(attr_);
      Client_SYS.Add_To_Attr('ACTIVEIND_DB', 'N', attr_);      
      
      SALES_PART_API.MODIFY__(info_, objid_, objversion_, attr_, 'DO');
      --COMMIT;
   END LOOP;   
END;

-----------------------
DECLARE   
   CURSOR get_qaman IS
      SELECT a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion
      FROM  SALES_PART a      
      WHERE a.ACTIVEIND_DB <> 'N'
      AND (CATALOG_NO = '21021-13-00' OR CATALOG_NO = '21049-05-00' OR CATALOG_NO = '21049-06-00' OR CATALOG_NO = '21049-07-00' OR CATALOG_NO = '21049-07-00-ADP' OR CATALOG_NO = '21049-07-00-AHK' OR CATALOG_NO = '21049-07-00-AIS' OR CATALOG_NO = '21049-07-00-BLT' OR CATALOG_NO = '21049-07-00-MCM' OR CATALOG_NO = '21049-07-00-STY' OR CATALOG_NO = '21049-12-00' OR CATALOG_NO = '21053-05-00' OR CATALOG_NO = '21053-06-00' OR CATALOG_NO = '21053-07-00' OR CATALOG_NO = '21053-12-00' OR CATALOG_NO = '21057-05-00' OR CATALOG_NO = '21057-06-00' OR CATALOG_NO = '21057-07-00' OR CATALOG_NO = '21057-07-00-ADP' OR CATALOG_NO = '21057-07-00-BLT' OR CATALOG_NO = '21057-07-00-EPE' OR CATALOG_NO = '21057-07-00-SDD' OR CATALOG_NO = '21057-07-00-STY' OR CATALOG_NO = '21057-12-00' OR CATALOG_NO = '21075-13-00' OR CATALOG_NO = '21077-05-00' OR CATALOG_NO = '21077-06-00' OR CATALOG_NO = '21077-07-00' OR CATALOG_NO = '21077-12-00' OR CATALOG_NO = '21077-12-00-ADP' OR CATALOG_NO = '21077-12-00-AHK' OR CATALOG_NO = '21077-12-00-AIS' OR CATALOG_NO = '21077-12-00-SDD' OR CATALOG_NO = '21078-01-00' OR CATALOG_NO = '21078-02-00' OR CATALOG_NO = '21078-03-00' OR CATALOG_NO = '21088-01-00' OR CATALOG_NO = '21088-02-00' OR CATALOG_NO = '21088-03-00' OR CATALOG_NO = '21099-13-00' OR CATALOG_NO = '21099-18-00-AHK' OR CATALOG_NO = '21100-13-00' OR CATALOG_NO = '21105-13-00' OR CATALOG_NO = '21106-05-00' OR CATALOG_NO = '21106-06-00' OR CATALOG_NO = '21106-07-00' OR CATALOG_NO = '21106-12-00' OR CATALOG_NO = '21108-05-00' OR CATALOG_NO = '21108-06-00' OR CATALOG_NO = '21108-07-00' OR CATALOG_NO = '21108-12-00' OR CATALOG_NO = '21112-13-00' OR CATALOG_NO = '21112-13-00-SDD' OR CATALOG_NO = '21112-13-00-STY' OR CATALOG_NO = '21112-18-00' OR CATALOG_NO = '21116-05-00' OR CATALOG_NO = '21116-06-00' OR CATALOG_NO = '21116-07-00' OR CATALOG_NO = '21116-12-00' OR CATALOG_NO = '21122-05-00' OR CATALOG_NO = '21122-06-00' OR CATALOG_NO = '21122-07-00' OR CATALOG_NO = '21122-12-00' OR CATALOG_NO = '21124-05-00' OR CATALOG_NO = '21124-06-00' OR CATALOG_NO = '21124-07-00' OR CATALOG_NO = '21124-12-00' OR CATALOG_NO = '21124-12-00-ADP' OR CATALOG_NO = '21128-01-00' OR CATALOG_NO = '21128-02-00' OR CATALOG_NO = '21128-03-00' OR CATALOG_NO = '21131-13-00' OR CATALOG_NO = '21131-18-00' OR CATALOG_NO = '21131-18-00-BLT' OR CATALOG_NO = '21131-18-00-SDD' OR CATALOG_NO = '21132-13-00' OR CATALOG_NO = '21132-18-00' OR CATALOG_NO = '21134-05-00' OR CATALOG_NO = '21134-06-00' OR CATALOG_NO = '21134-07-00' OR CATALOG_NO = '21134-12-00' OR CATALOG_NO = '21153-05-00' OR CATALOG_NO = '21153-06-00' OR CATALOG_NO = '21153-07-00' OR CATALOG_NO = '21153-12-00' OR CATALOG_NO = '21174-05-00' OR CATALOG_NO = '21174-06-00' OR CATALOG_NO = '21174-07-00' OR CATALOG_NO = '21174-12-00' OR CATALOG_NO = '21212-13-00' OR CATALOG_NO = '21214-01-00' OR CATALOG_NO = '21214-02-00' OR CATALOG_NO = '21214-03-00' OR CATALOG_NO = '21214-03-00-SDD' OR CATALOG_NO = '21218-13-00' OR CATALOG_NO = '21229-04-00' OR CATALOG_NO = '21229-05-00' OR CATALOG_NO = '21229-06-00' OR CATALOG_NO = '21229-07-00' OR CATALOG_NO = '21229-08-00' OR CATALOG_NO = '21229-09-00' OR CATALOG_NO = '21229-10-00' OR CATALOG_NO = '21229-11-00' OR CATALOG_NO = '21229-12-00' OR CATALOG_NO = '21275-03-00' OR CATALOG_NO = '21275-13-00' OR CATALOG_NO = '21275-18-00-AHK' OR CATALOG_NO = '21286-01-00' OR CATALOG_NO = '21286-02-00' OR CATALOG_NO = '21286-03-00' OR CATALOG_NO = '21286-03-00-SDD' OR CATALOG_NO = '21298-13-00' OR CATALOG_NO = '21298-14-00' OR CATALOG_NO = '21298-15-00' OR CATALOG_NO = '21298-16-00' OR CATALOG_NO = '21298-17-00' OR CATALOG_NO = '21298-18-00' OR CATALOG_NO = '21298-18-00-AHK' OR CATALOG_NO = '21298-18-00-MCM' OR CATALOG_NO = '21298-18-00-SDD' OR CATALOG_NO = '21320-04-00' OR CATALOG_NO = '21320-05-00' OR CATALOG_NO = '21320-06-00' OR CATALOG_NO = '21320-07-00' OR CATALOG_NO = '21320-07-00-MCM' OR CATALOG_NO = '21320-08-00' OR CATALOG_NO = '21320-09-00' OR CATALOG_NO = '21320-10-00' OR CATALOG_NO = '21320-11-00' OR CATALOG_NO = '21320-12-00' OR CATALOG_NO = '21433-01-00' OR CATALOG_NO = '21433-02-00' OR CATALOG_NO = '21433-03-00' OR CATALOG_NO = '21459-04-00' OR CATALOG_NO = '21459-05-00' OR CATALOG_NO = '21459-06-00' OR CATALOG_NO = '21459-07-00' OR CATALOG_NO = '21459-08-00' OR CATALOG_NO = '21459-09-00' OR CATALOG_NO = '21459-10-00' OR CATALOG_NO = '21459-11-00' OR CATALOG_NO = '21459-12-00' OR CATALOG_NO = '21499-13-00' OR CATALOG_NO = '21499-14-00' OR CATALOG_NO = '21499-15-00' OR CATALOG_NO = '21499-16-00' OR CATALOG_NO = '21499-17-00' OR CATALOG_NO = '21499-18-00' OR CATALOG_NO = '21503-13-00' OR CATALOG_NO = '21503-14-00' OR CATALOG_NO = '21503-15-00' OR CATALOG_NO = '21503-16-00' OR CATALOG_NO = '21503-17-00' OR CATALOG_NO = '21503-18-00' OR CATALOG_NO = '21503-18-00-AHK' OR CATALOG_NO = '22125-04-00' OR CATALOG_NO = '22125-05-00' OR CATALOG_NO = '22125-06-00' OR CATALOG_NO = '22125-07-00' OR CATALOG_NO = '22125-08-00' OR CATALOG_NO = '22125-09-00' OR CATALOG_NO = '22125-10-00' OR CATALOG_NO = '22125-11-00' OR CATALOG_NO = '22125-12-00' OR CATALOG_NO = '22460-04-00' OR CATALOG_NO = '22460-05-00' OR CATALOG_NO = '22460-06-00' OR CATALOG_NO = '22460-07-00' OR CATALOG_NO = '22460-08-00' OR CATALOG_NO = '22460-09-00' OR CATALOG_NO = '22460-10-00' OR CATALOG_NO = '22460-11-00' OR CATALOG_NO = '22460-12-00' OR CATALOG_NO = '22460-12-00-ADP' OR CATALOG_NO = '22460-12-00-EPE' OR CATALOG_NO = '23066-04-00' OR CATALOG_NO = '23066-05-00' OR CATALOG_NO = '23066-06-00' OR CATALOG_NO = '23066-07-00' OR CATALOG_NO = '23066-08-00' OR CATALOG_NO = '23066-09-00' OR CATALOG_NO = '23066-10-00' OR CATALOG_NO = '23066-11-00' OR CATALOG_NO = '23066-12-00' OR CATALOG_NO = '23075-04-00' OR CATALOG_NO = '23075-05-00' OR CATALOG_NO = '23075-06-00' OR CATALOG_NO = '23075-07-00' OR CATALOG_NO = '23075-08-00' OR CATALOG_NO = '23075-09-00' OR CATALOG_NO = '23075-10-00' OR CATALOG_NO = '23075-11-00' OR CATALOG_NO = '23075-12-00' OR CATALOG_NO = '23084-04-00' OR CATALOG_NO = '23084-05-00' OR CATALOG_NO = '23084-06-00' OR CATALOG_NO = '23084-07-00' OR CATALOG_NO = '23084-08-00' OR CATALOG_NO = '23084-09-00' OR CATALOG_NO = '23084-10-00' OR CATALOG_NO = '23084-11-00' OR CATALOG_NO = '23084-12-00' OR CATALOG_NO = '23087-04-00' OR CATALOG_NO = '23087-05-00' OR CATALOG_NO = '23087-06-00' OR CATALOG_NO = '23087-07-00' OR CATALOG_NO = '23087-08-00' OR CATALOG_NO = '23087-09-00' OR CATALOG_NO = '23087-10-00' OR CATALOG_NO = '23087-11-00' OR CATALOG_NO = '23087-12-00' OR CATALOG_NO = '23101-04-00' OR CATALOG_NO = '23101-05-00' OR CATALOG_NO = '23101-06-00' OR CATALOG_NO = '23101-07-00' OR CATALOG_NO = '23101-08-00' OR CATALOG_NO = '23101-09-00' OR CATALOG_NO = '23101-10-00' OR CATALOG_NO = '23101-11-00' OR CATALOG_NO = '23101-12-00' OR CATALOG_NO = '23103-04-00' OR CATALOG_NO = '23103-05-00' OR CATALOG_NO = '23103-06-00' OR CATALOG_NO = '23103-07-00' OR CATALOG_NO = '23103-08-00' OR CATALOG_NO = '23103-09-00' OR CATALOG_NO = '23103-10-00' OR CATALOG_NO = '23103-11-00' OR CATALOG_NO = '23103-12-00' OR CATALOG_NO = '23121-04-00' OR CATALOG_NO = '23121-05-00' OR CATALOG_NO = '23121-06-00' OR CATALOG_NO = '23121-07-00' OR CATALOG_NO = '23121-08-00' OR CATALOG_NO = '23121-09-00' OR CATALOG_NO = '23121-10-00' OR CATALOG_NO = '23121-11-00' OR CATALOG_NO = '23121-12-00' OR CATALOG_NO = '25007-13-00' OR CATALOG_NO = '25007-14-00' OR CATALOG_NO = '25007-15-00' OR CATALOG_NO = '25007-16-00' OR CATALOG_NO = '25007-17-00' OR CATALOG_NO = '25007-18-00' OR CATALOG_NO = '89013-04-00' OR CATALOG_NO = '89013-05-00' OR CATALOG_NO = '89013-06-00' OR CATALOG_NO = '89013-07-00' OR CATALOG_NO = '89013-07-00-AHK' OR CATALOG_NO = '89013-07-00-SDD' OR CATALOG_NO = '89013-08-00' OR CATALOG_NO = '89013-09-00' OR CATALOG_NO = '89013-10-00' OR CATALOG_NO = '89013-11-00' OR CATALOG_NO = '89013-12-00' OR CATALOG_NO = '89024-13-00' OR CATALOG_NO = '89024-14-00' OR CATALOG_NO = '89024-15-00' OR CATALOG_NO = '89024-16-00' OR CATALOG_NO = '89024-17-00' OR CATALOG_NO = '89024-18-00' OR CATALOG_NO = '89026-13-00' OR CATALOG_NO = '89026-14-00' OR CATALOG_NO = '89026-15-00' OR CATALOG_NO = '89026-16-00' OR CATALOG_NO = '89026-17-00' OR CATALOG_NO = '89026-18-00' OR CATALOG_NO = '89029-13-00' OR CATALOG_NO = '89029-14-00' OR CATALOG_NO = '89029-15-00' OR CATALOG_NO = '89029-16-00' OR CATALOG_NO = '89029-17-00' OR CATALOG_NO = '89029-18-00' OR CATALOG_NO = '89030-13-00' OR CATALOG_NO = '89030-14-00' OR CATALOG_NO = '89030-15-00' OR CATALOG_NO = '89030-16-00' OR CATALOG_NO = '89030-17-00' OR CATALOG_NO = '89030-18-00' OR CATALOG_NO = '89033-13-00' OR CATALOG_NO = '89033-14-00' OR CATALOG_NO = '89033-15-00' OR CATALOG_NO = '89033-16-00' OR CATALOG_NO = '89033-17-00' OR CATALOG_NO = '89033-18-00' OR CATALOG_NO = '89034-13-00' OR CATALOG_NO = '89034-14-00' OR CATALOG_NO = '89034-15-00' OR CATALOG_NO = '89034-16-00' OR CATALOG_NO = '89034-17-00' OR CATALOG_NO = '89034-18-00' OR CATALOG_NO = '89037-01-00' OR CATALOG_NO = '89037-01-00-SDD' OR CATALOG_NO = '89037-02-00' OR CATALOG_NO = '89037-03-00' OR CATALOG_NO = '89037-03-00-BLT' OR CATALOG_NO = '89038-13-00' OR CATALOG_NO = '89038-14-00' OR CATALOG_NO = '89038-15-00' OR CATALOG_NO = '89038-16-00' OR CATALOG_NO = '89038-17-00' OR CATALOG_NO = '89038-18-00' OR CATALOG_NO = '89039-13-00' OR CATALOG_NO = '89039-14-00' OR CATALOG_NO = '89039-15-00' OR CATALOG_NO = '89039-16-00' OR CATALOG_NO = '89039-17-00' OR CATALOG_NO = '89039-18-00' OR CATALOG_NO = '89043-04-00' OR CATALOG_NO = '89043-05-00' OR CATALOG_NO = '89043-06-00' OR CATALOG_NO = '89043-07-00' OR CATALOG_NO = '89043-07-00-GTX' OR CATALOG_NO = '89043-08-00' OR CATALOG_NO = '89043-09-00' OR CATALOG_NO = '89043-10-00' OR CATALOG_NO = '89043-11-00' OR CATALOG_NO = '89043-12-00' OR CATALOG_NO = '89046-04-00' OR CATALOG_NO = '89046-05-00' OR CATALOG_NO = '89046-06-00' OR CATALOG_NO = '89046-07-00' OR CATALOG_NO = '89046-08-00' OR CATALOG_NO = '89046-09-00' OR CATALOG_NO = '89046-10-00' OR CATALOG_NO = '89046-11-00' OR CATALOG_NO = '89046-12-00' OR CATALOG_NO = '89053-04-00' OR CATALOG_NO = '89053-05-00' OR CATALOG_NO = '89053-06-00' OR CATALOG_NO = '89053-07-00' OR CATALOG_NO = '89053-08-00' OR CATALOG_NO = '89053-09-00' OR CATALOG_NO = '89053-10-00' OR CATALOG_NO = '89053-11-00' OR CATALOG_NO = '89053-12-00' OR CATALOG_NO = '89058-13-00' OR CATALOG_NO = '89058-14-00' OR CATALOG_NO = '89058-15-00' OR CATALOG_NO = '89058-16-00' OR CATALOG_NO = '89058-17-00' OR CATALOG_NO = '89058-18-00' OR CATALOG_NO = '89066-04-00' OR CATALOG_NO = '89066-05-00' OR CATALOG_NO = '89066-06-00' OR CATALOG_NO = '89066-07-00' OR CATALOG_NO = '89066-08-00' OR CATALOG_NO = '89066-09-00' OR CATALOG_NO = '89066-10-00' OR CATALOG_NO = '89066-11-00' OR CATALOG_NO = '89066-12-00' OR CATALOG_NO = '89068-04-00' OR CATALOG_NO = '89068-05-00' OR CATALOG_NO = '89068-06-00' OR CATALOG_NO = '89068-07-00' OR CATALOG_NO = '89068-08-00' OR CATALOG_NO = '89068-09-00' OR CATALOG_NO = '89068-10-00' OR CATALOG_NO = '89068-11-00' OR CATALOG_NO = '89068-12-00' OR CATALOG_NO = '89070-13-00' OR CATALOG_NO = '89070-14-00' OR CATALOG_NO = '89070-15-00' OR CATALOG_NO = '89070-16-00' OR CATALOG_NO = '89070-17-00' OR CATALOG_NO = '89070-18-00' OR CATALOG_NO = '89075-13-00' OR CATALOG_NO = '89075-14-00' OR CATALOG_NO = '89075-15-00' OR CATALOG_NO = '89075-16-00' OR CATALOG_NO = '89075-17-00' OR CATALOG_NO = '89075-18-00' OR CATALOG_NO = '89078-01-00' OR CATALOG_NO = '89078-02-00' OR CATALOG_NO = '89078-03-00' OR CATALOG_NO = '89082-01-00' OR CATALOG_NO = '89082-02-00' OR CATALOG_NO = '89082-03-00' OR CATALOG_NO = '89082-03-00-SDD' OR CATALOG_NO = '89086-04-00' OR CATALOG_NO = '89086-05-00' OR CATALOG_NO = '89086-06-00' OR CATALOG_NO = '89086-07-00' OR CATALOG_NO = '89086-07-00-AHK' OR CATALOG_NO = '89086-08-00' OR CATALOG_NO = '89086-09-00' OR CATALOG_NO = '89086-10-00' OR CATALOG_NO = '89086-11-00' OR CATALOG_NO = '89086-12-00' OR CATALOG_NO = '89090-01-00' OR CATALOG_NO = '89090-02-00' OR CATALOG_NO = '89090-03-00' OR CATALOG_NO = '89102-12-00' OR CATALOG_NO = '89102-12-00-MCM' OR CATALOG_NO = '89102-13-00' OR CATALOG_NO = '89102-14-00' OR CATALOG_NO = '89102-15-00' OR CATALOG_NO = '89102-16-00' OR CATALOG_NO = '89102-17-00' OR CATALOG_NO = '89102-18-00' OR CATALOG_NO = '89104-04-00' OR CATALOG_NO = '89104-05-00' OR CATALOG_NO = '89104-06-00' OR CATALOG_NO = '89104-07-00' OR CATALOG_NO = '89104-08-00' OR CATALOG_NO = '89104-09-00' OR CATALOG_NO = '89104-10-00' OR CATALOG_NO = '89104-11-00' OR CATALOG_NO = '89104-12-00' OR CATALOG_NO = '89115-04-00' OR CATALOG_NO = '89115-05-00' OR CATALOG_NO = '89115-06-00' OR CATALOG_NO = '89115-07-00' OR CATALOG_NO = '89115-07-00-SDD' OR CATALOG_NO = '89115-08-00' OR CATALOG_NO = '89115-09-00' OR CATALOG_NO = '89115-10-00' OR CATALOG_NO = '89115-11-00' OR CATALOG_NO = '89115-12-00' OR CATALOG_NO = '89116-04-00' OR CATALOG_NO = '89116-05-00' OR CATALOG_NO = '89116-06-00' OR CATALOG_NO = '89116-07-00' OR CATALOG_NO = '89116-08-00' OR CATALOG_NO = '89116-09-00' OR CATALOG_NO = '89116-10-00' OR CATALOG_NO = '89116-11-00' OR CATALOG_NO = '89116-12-00' OR CATALOG_NO = '89121-04-00' OR CATALOG_NO = '89121-05-00' OR CATALOG_NO = '89121-06-00' OR CATALOG_NO = '89121-07-00' OR CATALOG_NO = '89121-08-00' OR CATALOG_NO = '89121-09-00' OR CATALOG_NO = '89121-10-00' OR CATALOG_NO = '89121-11-00' OR CATALOG_NO = '89121-12-00' OR CATALOG_NO = '89122-13-00' OR CATALOG_NO = '89122-14-00' OR CATALOG_NO = '89122-15-00' OR CATALOG_NO = '89122-16-00' OR CATALOG_NO = '89122-17-00' OR CATALOG_NO = '89122-18-00' OR CATALOG_NO = '89131-01-00' OR CATALOG_NO = '89131-01-00-AHK' OR CATALOG_NO = '89131-02-00' OR CATALOG_NO = '89131-03-00' OR CATALOG_NO = '89136-01-00' OR CATALOG_NO = '89136-01-00-AHK' OR CATALOG_NO = '89136-02-00' OR CATALOG_NO = '89136-03-00' OR CATALOG_NO = '89137-04-00' OR CATALOG_NO = '89137-05-00' OR CATALOG_NO = '89137-06-00' OR CATALOG_NO = '89137-07-00' OR CATALOG_NO = '89137-08-00' OR CATALOG_NO = '89137-09-00' OR CATALOG_NO = '89137-10-00' OR CATALOG_NO = '89137-11-00' OR CATALOG_NO = '89137-12-00' OR CATALOG_NO = '89141-13-00' OR CATALOG_NO = '89141-14-00' OR CATALOG_NO = '89141-15-00' OR CATALOG_NO = '89141-16-00' OR CATALOG_NO = '89141-17-00' OR CATALOG_NO = '89141-18-00' OR CATALOG_NO = '89152-04-00' OR CATALOG_NO = '89152-05-00' OR CATALOG_NO = '89152-06-00' OR CATALOG_NO = '89152-07-00' OR CATALOG_NO = '89152-07-00-SDD' OR CATALOG_NO = '89152-08-00' OR CATALOG_NO = '89152-09-00' OR CATALOG_NO = '89152-10-00' OR CATALOG_NO = '89152-11-00' OR CATALOG_NO = '89152-12-00' OR CATALOG_NO = '89154-04-00' OR CATALOG_NO = '89154-05-00' OR CATALOG_NO = '89154-06-00' OR CATALOG_NO = '89154-07-00' OR CATALOG_NO = '89154-08-00' OR CATALOG_NO = '89154-09-00' OR CATALOG_NO = '89154-10-00' OR CATALOG_NO = '89154-11-00' OR CATALOG_NO = '89154-12-00' OR CATALOG_NO = '89160-01-00' OR CATALOG_NO = '89160-02-00' OR CATALOG_NO = '89160-03-00' OR CATALOG_NO = '89164-01-00' OR CATALOG_NO = '89164-02-00' OR CATALOG_NO = '89164-03-00' OR CATALOG_NO = '89182-13-00' OR CATALOG_NO = '89182-14-00' OR CATALOG_NO = '89182-15-00' OR CATALOG_NO = '89182-16-00' OR CATALOG_NO = '89182-17-00' OR CATALOG_NO = '89182-18-00' OR CATALOG_NO = '89189-01-00' OR CATALOG_NO = '89189-02-00' OR CATALOG_NO = '89189-03-00' OR CATALOG_NO = '89221-13-00' OR CATALOG_NO = '89221-14-00' OR CATALOG_NO = '89221-15-00' OR CATALOG_NO = '89221-16-00' OR CATALOG_NO = '89221-17-00' OR CATALOG_NO = '89221-18-00' OR CATALOG_NO = '89222-04-00' OR CATALOG_NO = '89222-05-00' OR CATALOG_NO = '89222-06-00' OR CATALOG_NO = '89222-07-00' OR CATALOG_NO = '89222-08-00' OR CATALOG_NO = '89222-09-00' OR CATALOG_NO = '89222-10-00' OR CATALOG_NO = '89222-11-00' OR CATALOG_NO = '89222-12-00' OR CATALOG_NO = '89230-04-00' OR CATALOG_NO = '89230-05-00' OR CATALOG_NO = '89230-06-00' OR CATALOG_NO = '89230-07-00' OR CATALOG_NO = '89230-08-00' OR CATALOG_NO = '89230-09-00' OR CATALOG_NO = '89230-10-00' OR CATALOG_NO = '89230-11-00' OR CATALOG_NO = '89230-12-00' OR CATALOG_NO = '89240-01-00' OR CATALOG_NO = '89240-02-00' OR CATALOG_NO = '89240-03-00' OR CATALOG_NO = '89241-13-00' OR CATALOG_NO = '89241-14-00' OR CATALOG_NO = '89241-15-00' OR CATALOG_NO = '89241-16-00' OR CATALOG_NO = '89241-17-00' OR CATALOG_NO = '89241-18-00' OR CATALOG_NO = '89254-04-00' OR CATALOG_NO = '89254-05-00' OR CATALOG_NO = '89254-06-00' OR CATALOG_NO = '89254-07-00' OR CATALOG_NO = '89254-08-00' OR CATALOG_NO = '89254-09-00' OR CATALOG_NO = '89254-10-00' OR CATALOG_NO = '89254-11-00' OR CATALOG_NO = '89254-12-00' OR CATALOG_NO = '89400-13-00' OR CATALOG_NO = '89400-14-00' OR CATALOG_NO = '89400-15-00' OR CATALOG_NO = '89400-16-00' OR CATALOG_NO = '89400-17-00' OR CATALOG_NO = '89400-18-00' OR CATALOG_NO = '89661-12-00');
      
   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000);   
   
BEGIN
   
   FOR row_ IN get_qaman LOOP      
      objid_ := row_.objid;
      objversion_ := row_.objversion;
      
      Client_SYS.Clear_Attr(attr_);
      Client_SYS.Add_To_Attr('ACTIVEIND_DB', 'N', attr_);      
      
      SALES_PART_API.MODIFY__(info_, objid_, objversion_, attr_, 'DO');
      --COMMIT;
   END LOOP;   
END;



--------------
DROP TABLE MTK_INVENTORY_PART_CF_TAB;

CREATE TABLE MTK_INVENTORY_PART_CF_TAB
(
   PART_NO                            VARCHAR2(25)        NOT NULL,
   CONTRACT                           VARCHAR2(5)         NOT NULL,
   VENDOR_NO                          VARCHAR2(20)        NOT NULL
);

SELECT 'INSERT INTO MTK_INVENTORY_PART_CF_TAB (PART_NO,CONTRACT,VENDOR_NO) VALUES (''' 
+ LTRIM(RTRIM(PART_NO)) 
+ ''',''' + CONTRACT 
+ ''',''' + VENDOR_NO 
+  ''');'   aa
FROM ( SELECT  [Part No]	PART_NO  
	  ,[Site]				CONTRACT
      ,[Supplier No]  VENDOR_NO
  FROM [dbo].[delete_supplier_purch_parts$]
  GROUP BY [Part No],[Site],[Supplier No] ) aaa

----  Delete Saupplier for Purchase Parts
DECLARE   
   CURSOR get_qaman IS
      SELECT a.PART_NO,
             a.contract,
             a.VENDOR_NO,
             a.objid,            
             a.objversion
		FROM  PURCHASE_PART_SUPPLIER a
      INNER JOIN MTK_INVENTORY_PART_CF_TAB b ON b.PART_NO = a.PART_NO AND b.CONTRACT = a.CONTRACT AND b.VENDOR_NO = a.VENDOR_NO;     

   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000);      
BEGIN
   
   FOR row_ IN get_qaman LOOP
      objid_ := row_.objid;
      objversion_ := row_.objversion;
      
      PURCHASE_PART_SUPPLIER_API.REMOVE__(info_, objid_, objversion_, 'DO');
      --COMMIT;
   END LOOP;   
END;


----Delete PurchasePart
DECLARE   
   CURSOR get_qaman1 IS
      SELECT a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion
		FROM  PURCHASE_PART_LANG_DESC a
      INNER JOIN MTK_INVENTORY_PART_CF_TAB b ON b.PART_NO = a.PART_NO AND b.CONTRACT = a.CONTRACT
      LEFT JOIN PURCHASE_ORDER_LINE c ON c.PART_NO = a.PART_NO AND c.CONTRACT = a.CONTRACT
      WHERE c.PART_NO IS NULL
      GROUP BY a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion;     
   
   CURSOR get_qaman2 IS
      SELECT a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion
		FROM  PURCHASE_PART a
      INNER JOIN MTK_INVENTORY_PART_CF_TAB b ON b.PART_NO = a.PART_NO AND b.CONTRACT = a.CONTRACT
      LEFT JOIN PURCHASE_ORDER_LINE c ON c.PART_NO = a.PART_NO AND c.CONTRACT = a.CONTRACT
      LEFT JOIN SALES_PART d ON d.PART_NO = a.PART_NO AND d.CONTRACT = a.CONTRACT
      WHERE c.PART_NO IS NULL
      AND d.PART_NO IS NULL
      GROUP BY a.PART_NO,
             a.contract,
             a.objid,            
             a.objversion;     

   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000);      
BEGIN
   
   FOR row_ IN get_qaman1 LOOP
      objid_ := row_.objid;
      objversion_ := row_.objversion;      
      PURCHASE_PART_LANG_DESC_API.REMOVE__(info_, objid_, objversion_, 'DO');
      --COMMIT;
   END LOOP;   
      
   FOR row_ IN get_qaman2 LOOP
      objid_ := row_.objid;
      objversion_ := row_.objversion;      
      PURCHASE_PART_API.REMOVE__(info_, objid_, objversion_, 'DO');
      --COMMIT;
   END LOOP;   
END;

  