-----CUSTOMER_INFO
SELECT
      a.customer_id CUSTOMER_NO,
      a.NAME,
      a.ASSOCIATION_NO,
      a.COUNTRY,
      a.CREATION_DATE,
      a.CORPORATE_FORM,
      a.IDENTIFIER_REFERENCE,
      a.IDENTIFIER_REF_VALIDATION_DB,
      c.CUST_GRP,
      c.CUST_PRICE_GROUP_ID,
      c.CUST_REF,
      c.MARKET_CODE,
      c.DISCOUNT_TYPE,
      c.DISCOUNT,
      c.CURRENCY_CODE,
      '' ALLOW_BACKORDERS_DB,
      c.CUSTOMER_NO_PAY,
      '' BONUS_CLASS,
      '' BONUS_RATE,
      '' BONUS_SALES,
      c.SALESMAN_CODE,
      c.PACK_LIST_FLAG_DB,
      c.ORDER_ID,
      c.DATE_DEL,
      c.ORDER_CONF_FLAG_DB,
      c.SUMMARIZED_SOURCE_LINES_DB,
      c.EDI_AUTO_ORDER_APPROVAL_DB,
      c.EDI_AUTO_APPROVAL_USER,
      c.EDI_AUTHORIZE_CODE,
      c.EDI_SITE,
      '*' MTK_MODE,
      c.CUST_PART_ACQ_VAL_LEVEL_DB,
      c.CUST_PART_OWNER_TRANSFER_DB,
      c.COMMISSION_RECEIVER_DB,
      c.BACKORDER_OPTION_DB,
      a.DEFAULT_LANGUAGE_DB,
      c.CREDIT_CONTROL_GROUP_ID,
      '' NOTE_TEXT,
      c.MIN_SALES_AMOUNT,
      c.RECEIVE_PACK_SIZE_CHG_DB, 
      c.ADV_INV_FULL_PAY_DB      
FROM CUSTOMER_INFO a
INNER JOIN IDENTITY_INVOICE_INFO b ON a.customer_id = b.identity 
INNER JOIN CUST_ORD_CUSTOMER_ENT c ON a.customer_id = c.customer_id
--WHERE a.customer_id IN('5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
--AND b.COMPANY = '41-POL'
WHERE b.COMPANY = '40-UK'

------CUSTOMER_INFO_ADDRESS
SELECT
   a.customer_id CUSTOMER_NO,
   a.ADDRESS_ID,
   ADDRESS1,
   ADDRESS2,
   CITY,
   STATE,
   ZIP_CODE,
   COUNTY,
   COUNTRY,
   IN_CITY,
   '' TAX_METHOD_DB,
   VALID_FROM,
   VALID_TO,
   PRIMARY_CONTACT,
   SECONDARY_CONTACT,
   '' DEF_ADDRESS_PAY,
   '' DEF_ADDRESS_DOCUMENT,
   '' DEF_ADDRESS_DELIVERY,
   '' DEF_ADDRESS_PRIMARY_CONTACT,
   '' DEF_ADDRESS_SECONDARY_CONTACT,
   '' DEF_ADDRESS_VISIT,
   '' DEF_ADDRESS_HOME,
   COMPANY_NAME2,
   DELIVERY_TERMS,
   DELIVERY_TERMS_DESC,
   SHIP_VIA_CODE,
   ROUTE_ID,
   LOAD_SEQUENCE_NO,
   DELIVERY_TIME,
   CONTACT,   
   REGION_CODE,
   DISTRICT_CODE,
   INTRASTAT_EXEMPT_DB,
   SHIPMENT_CREATION_DB,
   MULTI_LOT_BATCH_PER_PALLET_DB,
   '' MTK_MODE,
   EAN_LOCATION,
   SHIPMENT_MEASURE_EDIT_DB
--FROM CUSTOMER_INFO_ADDRESS a
--LEFT JOIN CUST_ORD_CUSTOMER_ADDRESS_ENT b ON a.CUSTOMER_ID = b.CUSTOMER_ID AND a.ADDRESS_ID = b.ADDRESS_ID
--WHERE a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
FROM CUSTOMER_INFO_ADDRESS a
INNER JOIN IDENTITY_INVOICE_INFO b ON a.customer_id = b.identity 
LEFT JOIN CUST_ORD_CUSTOMER_ADDRESS_ENT b ON a.CUSTOMER_ID = b.CUSTOMER_ID AND a.ADDRESS_ID = b.ADDRESS_ID
WHERE b.COMPANY = '40-UK'

------Customer-Company
SELECT 
   a.identity  CUSTOMER_ID,
   a.COMPANY,
   '' WAY_ID,
   b.CREDIT_RATING,
   b.CREDIT_ANALYST_CODE,
   b.CREDIT_LIMIT,
   b.PARENT_IDENTITY,
   a.GROUP_ID,
   a.PAY_TERM_ID,
   a.DEF_CURRENCY, 
   a.CURRENCY_CODE,
   a.EXPIRE_DATE,
   '' OTHER_PAYEE_IDENTITY,
   '' MTK_MODE,
   b.CREDIT_NUMBER,
   b.AVG_DAYS_FOR_PAYMENT,
   b.CREDIT_COMMENTS,
   b.CREDIT_BLOCK,
   b.NEXT_REVIEW_DATE,
   b.ALLOWED_DUE_DAYS,
   b.ALLOWED_DUE_AMOUNT,
   a.IDENTITY_TYPE_DB,
   '' NOTES,
   b.LAST4Q_SALES,
   ''ADD_PAYMENT_RECORD,
   '' INTEREST_TEMPLATE   
FROM IDENTITY_INVOICE_INFO a
LEFT JOIN CUSTOMER_CREDIT_INFO_CUST b ON b.identity = a.identity AND b.COMPANY = a.COMPANY
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE a.identity IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
--AND a.COMPANY = '41-POL'
WHERE a.COMPANY = '40-UK'

-----Customer-Info-Comm-Method
SELECT
   a.IDENTITY CUSTOMER_ID,
   a.COMM_ID,
   a.VALUE,
   a.DESCRIPTION,
   a.VALID_FROM,
   a.VALID_TO,
   a.METHOD_DEFAULT,
   a.ADDRESS_DEFAULT,
   a.METHOD_ID_DB,
   a.ADDRESS_ID,
   a.NAME   
FROM COMM_METHOD a
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
WHERE a.PARTY_TYPE_DB = 'CUSTOMER' 
--AND a.identity IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
--AND c.COMPANY = '41-POL'
AND c.COMPANY = '40-UK'

----Customer_Document-Text
SELECT 
   a.CUSTOMER_ID,
   b.NOTE_TEXT,
   b.OUTPUT_TYPE   
FROM CUST_ORD_CUSTOMER_ENT a
INNER JOIN DOCUMENT_TEXT b ON b.note_id = a.note_id AND output_type != 'PURCHASE'
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE c.COMPANY = '20-MEX'
WHERE c.COMPANY = '40-UK'

---Customer-Tax-info
SELECT
   a.CUSTOMER_ID,
   a.ADDRESS_ID,
   a.COMPANY,
   a.TAX_REGIME_DB,
   a.TAX_WITHHOLDING_DB,
   a.TAX_ROUNDING_METHOD_DB,
   a.TAX_ROUNDING_LEVEL_DB,
   '' MTK_MODE   
FROM CUSTOMER_TAX_INFO a
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERe a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
--AND c.PARTY_TYPE = 'Customer'
--AND a.COMPANY = '41-POL'
WHERe c.PARTY_TYPE = 'Customer'
AND a.COMPANY = '40-UK'

-----CUSTOMER_DELIVERY_TAX_INFO
SELECT 
   a.CUSTOMER_ID,
   a.ADDRESS_ID,
   a.COMPANY,
   a.SUPPLY_COUNTRY_DB,
   a.LIABILITY_TYPE,
   a.TAX_BOOK_ID,
   a.TAX_BOOK_TYPE,
   a.TAX_STRUCTURE_ID,
   '' MTK_MODE
FROM  CUSTOMER_DELIVERY_TAX_INFO a
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE A.COMPANY = '41-POL'
--AND c.PARTY_TYPE = 'Customer'
--AND a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
WHERE A.COMPANY = '40-UK'
AND c.PARTY_TYPE = 'Customer'

---Customer-Delivery-Fee-Code
SELECT 
   a.COMPANY,
   FEE_CODE,
   a.CUSTOMER_ID IDENTITY,
   C.PARTY_TYPE_DB,
   a.ADDRESS_ID,
   TAX_ID_NUMBER,
   '' MTK_MODE,
   SUPPLY_COUNTRY_DB   
FROM  CUSTOMER_DELIVERY_TAX_INFO a
INNER JOIN CUSTOMER_DELIVERY_FEE_CODE b ON a.COMPANY = b.COMPANY AND a.CUSTOMER_ID = b.CUSTOMER_ID AND a.ADDRESS_ID = b.ADDRESS_ID
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE A.COMPANY = '41-POL'
--AND c.PARTY_TYPE = 'Customer'
--AND a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
WHERE A.COMPANY = '40-UK'
AND c.PARTY_TYPE = 'Customer'

----Customer Tax Free Tax Code
SELECT 
   a.CUSTOMER_ID,
   a.ADDRESS_ID,
   a.COMPANY,
   a.SUPPLY_COUNTRY_DB,
   b.DELIVERY_TYPE,
   b.VAT_FREE_VAT_CODE,
   '' MTK_MODE
FROM  CUSTOMER_DELIVERY_TAX_INFO a
INNER JOIN CUSTOMER_TAX_FREE_TAX_CODE b ON b.CUSTOMER_ID = a.CUSTOMER_ID AND
   b.ADDRESS_ID = a.ADDRESS_ID AND
   b.COMPANY = a.COMPANY
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE A.COMPANY = '41-POL' AND 
--c.PARTY_TYPE = 'Customer'
--AND a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
WHERE A.COMPANY = '40-UK' AND 
c.PARTY_TYPE = 'Customer'

----CUSTOMER_IPD_TAX_INFO_ADDR
SELECT 
   a.CUSTOMER_ID,
   a.ADDRESS_ID,
   a.COMPANY,
   a.SUPPLY_COMPANY,
   a.SUPPLY_COUNTRY_DB,
   a.LIABILITY_TYPE,
   a.TAX_ID_TYPE,
   a.VAT_NO,
   a.VALIDATED_DATE,
   '' MTK_MODE
FROM  CUSTOMER_IPD_TAX_INFO_ADDR a
INNER JOIN IDENTITY_INVOICE_INFO c ON a.customer_id = c.identity 
--WHERE c.COMPANY = '41-POL' AND 
--c.PARTY_TYPE = 'Customer'
--AND a.CUSTOMER_ID IN('1128','1129','1174','1348','1375','1533','1786','1809','1814','1816','1834','1900','2029','2030','2031','2217','2267','2290','2292','2309','2600','3008','3009','5000','5001','5002','5003','5004','5005','5006','5007','5008','5009','5010','5011','5012','5013','5014','5015','5016','5017','5018','5019','5020','5021','5022','5023','5024','5025','5026','5027','5028','5029','5030','5031','5032','5033','5034','5035','5036','5037','5038','5039','5040','5041','5042','5043','5044','5045','5046','5047','5048','5049','5050','5051','5052','5053','5054','5055','5056','5057','5058','5059','5060','5061','5062','5063','5064','5065','5066','5067','5068','5069','5070','5071','5072','5073','5074','5075','5076','5077','5078','5080','5081','5082','5083','5084','5085','5086','5087','5088','5089','5090','5091','5092','5093','5094','5095','5096','5097','5098','5099','5100','5101','5102','5103','5104','5105','5106','5107','5108','5109','5110','5111','5112','5113','5114','5115','5116','5117','5118','5119','5120','5121','5122','5123','5124','5125','5126','5127','5128','5129','5130','5131','5132','5133','5134','5135','5136','5137','5138','5139','5140','5141','5142','5143','5144','5146','5147')
WHERE c.COMPANY = '40-UK' AND 
c.PARTY_TYPE = 'Customer'

---

DECLARE   
   CURSOR get_qaman IS
      SELECT  qcp.objid,
              qcp.objversion
      FROM CUST_ORD_CUSTOMER_ENT qcp
      WHERE customer_id >= 3500
      AND CUST_GRP <> 'GENERAL'; 
   
   info_                VARCHAR2(32000);
   objid_               VARCHAR2(32000);
   objversion_          VARCHAR2(32000);
   attr_                VARCHAR2(26000); 
BEGIN   
   FOR row_ IN get_qaman LOOP
      objid_ := row_.objid;
      objversion_ := row_.objversion;
      Client_SYS.Clear_Attr(attr_);
      Client_SYS.Add_To_Attr('CUST_GRP', 'GENERAL', attr_);     
         
      CUST_ORD_CUSTOMER_API.MODIFY__(info_, objid_, objversion_, attr_, 'DO');      
   END LOOP;   
END;